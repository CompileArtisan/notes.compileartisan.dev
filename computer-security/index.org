#+title: Computer Security
#+SETUPFILE: /home/praaneshnair/.config/doom/templates/org/html-preamble.org

* Introduction

** Types of Security
*** Computer Security
- It is designed to protect data which is stored in a device with the help of
  tools.

*** Network Security
- It is designed to protect data during transmission using LAN, WAN.

*** Internet Security
- It is designed to protect data during their transmission over an
  interconnected network.
  
** What is an information system?
- Any form of hardware or software used to store information.
- It consists of computing resources (processor, memory, RAM, etc), data,
  processes, software.


* CIA Triad: What is Computer Security? 
- The protection provided to an automated information system in order to attain
  the applicable objectives of preserving the *confidentiality*, *integrity* and
  *availability* of information system resources.

** Confidentiality
- Give authorization to access data.
- Confidentiality covers two concepts:
  
*** Data Confidentiality
- Confidentiality tells us that if you have the authorization, you can access
  data.

*** Privacy
- Privacy tells us that even if you are authorized, you may not be able to
  access all of the data.

** Integrity
- The data you store and the data you retrieve should be the same: it shouldn't
  be manipulated or destroyed in the process.
- Again, integrity covers two concepts:

*** Data Integrity
- 

*** System Integrity
- The information system should not be tamper-able.
- For example, an ATM machine should have system integrity. Data integrity
  should be ensured in the bank account.

** Availability
- The data should be available without any hurdles.

* Three Aspects of Information Security

** Security Attack
- Actions which compromise on security information.
- It is an assualt on system security that derives from an intelligent threat.
- The basic two types of attacks are:

*** Security Threat
- It's a potential danger that might exploit vulnerability.

*** Two types of Attacks

**** Active Attack
- An attacker tries to modify the content of the messages.
- The data stream is directly modified. 
- This is a threat for System Integrity and Availability.
- You can't prevent an active attack. You get to know about it only after the
  content of the messages is modified.
- Examples include Password Tracking, Replay Attack and Viruses.


**** Passive Attack
- An attacker observes the messages, and uses them for malicious purposes
  information.
- Here, the data stream is just monitored, not modified.
- This is a threat for Confidentiality.
- You can prevent and detect a passive attack. A passive attack becomes an
  active attack when data is modified.
- Examples include snooping, sniffing and eavesdropping.

** Security Service
- It is intended to counter security attacks by using security mechanisms.
- It replicates functions normally associated with physical documents.
- Services are essentially the desired outcomes (essentially the CIA triad) of a
  protected system.

*** Definitions by different standards

**** X.800
- It's a 

***** Authentication

***** Access Control (Data Privacy)

***** Confidentiality

***** Data Integrity

***** Non-Repudiation (Rejection)
- Protection against Denial of Service.

*** Notorization
- It's an official witness for signing a document. The person/body who does this
  is called a notary.

** Security Mechanism
- These are HOW to counter security attacks (detect one, or recover from one).
- They involve the tools/methods like cryptography or key-establishments.

* OSI Security Architecture
- It's a standard framework of 

* Models for the Security of Network
There are two models for security of networks

** Model for Network Security
- The sender passes *secret information* (key) as an argument, and runs a
  *security-related transformation* (encryption) on the message.
- The output of this is an encrypted message.
- This encrypted message passes through an *information channel* which is open to
  anyone and absolutely any passive attack.
- The reciever passes *secret information* (key) as an argument, and runs a
  *security-related transformation* (decryption) on the encrypted message and gets
  back the original message.
- The keys and the information channel is provided by a *trusted third party*.

  file:/home/praaneshnair/gitProjects/org-notes/computer-security/network_security.png

** Model for Network Access Security
- This model requires to select an appropriate *gatekeeper function* to identify
  the user of an information system.
- The gatekeeper function is a security checkpoint which decides who can enter
  and what actions are allowed.
- Even after entry to the system, security continues to provide role-based
  *access control*, *file-permissions*, and *login*.

*** Types of attacks on access controls

**** Brute-Force Attacks
- You keep trying all combinations of characters in all possible lengths, until
  you actually crack the password.

**** Dictionary Attacks
 - Guessing passwords from a predefined dictionary of common words, phrases and
   passwords,

*** Layered Security Tools/Devices


| Firewall                                                                                                        | IPS                                                                                                                                 | IDS                                                                                                                                       |
|-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------|
| It's a network security device that filters incoming and outgoing traffic based on IP address and port numbers. | Intrusion Prevention System is a network security device that detects, inspects the contents of the packets and classifies traffic. | Intrusion Detection System is a network security device or software that monitors traffic for malicious activity and alerts on detection. |
| This should be the first line of defence.                                                                       | Should be placed after firewall.                                                                                                    | Should be placed after firewall.                                                                                                          |
| Blocks traffic.                                                                                                 | Prevents traffic when anomaly is detected.                                                                                          | Alerts on detection of anomaly.                                                                                                           |




*** Zero-Day Attack
- It's an attack that can happen at any point of time, without any prior signs.
- Zero-day attack happens when a malicious actor uses a zero-day attack to plant
  malware.

* Malicious Program

** Host Dependent Malicious Programs

*** Virus
- It's a malicious program that replicates itself and spread across the files of
  the same system.
*** Trojan Horse
- These are malware that are disguised as legitimate programs/softwares to trick
  the users into installing them.
*** Trapdoors/Backdoor
- Malware which enter using undocumented entry points.
*** Logic Bomb
- Malware that remain inactive until some conditions are met.

** Host independent Malicious Programs

*** Worms
- It's a malicious program that replicates itself (just like viruses), but they
  spread across different systems.
- The first worm in the world is called the *Morris Worm*, and was released in
  November 1988 by Robert Morris (Not Robert Worm).

*** Zombie
- It takes control of an entire system.

* Cryptography

** Basic Terminology

| Word          | Meaning                                                       |
|---------------+---------------------------------------------------------------|
| *Plain Text*    | Original Message                                              |
| *Cipher Text*   | Encrypted Message                                             |
| *Cipher*        | Algorithm for encrypting                                      |
| *Key*           | Secret Info, used in Cipher only known to sender and Reciever |
| *Encipher*      | Process of Encrypting                                         |
| *Decipher*      | Process of Decrypting                                         |
| *Cryptography*  | Study of Encryption Principles/Methods                        |
| *Cryptanalysis* | Study of deciphering cipher text, without knowing the key     |
| *Cryptology*    | Field of both cryptography and cryptanalysis                  |

** Types of Cryptography

*** Based on Encryption Techniques

**** Substitution

***** Classical Substitution Cipher
- Every occurrence of a plain text symbol is replaced by a corresponding
  ciphertext character.

****** Ceaser/Shift Cipher
This is the earliest known subsitution cipher.
\[ C_{1} = e(m_{1}) = m_{1} + k\mod(s) \]

******* For example, let m = college, k = 3 and s = 26.

- C_{1}[1] = (position of 'c') + 3mod(26) = f
- C_{1}[2] = (position of 'o') + 3mod(26) = r
- C_{1}[3] = (position of 'l') + 3mod(26) = o
- C_{1}[4] = (position of 'l') + 3mod(26) = o
- C_{1}[5] = (position of 'e') + 3mod(26) = h
- C_{1}[6] = (position of 'g') + 3mod(26) = j
- C_{1}[7] = (position of 'e') + 3mod(26) = h
- Hence, C_{1} = e(college) = froohjh


******* In general, for alphabets, Ceasar Cipher is given as

| *Encryption:* | $E(P) = (P+K)\mod(26)$  |
| *Decryption:* | $D(C) = (C-K)\mod(26)$  |


******* For example, Encrypt KHOOR with k=4
- C_{1}[1] = (position of 'K') + 4mod(26) = O
- C_{1}[2] = (position of 'H') + 4mod(26) = L
- C_{1}[3] = (position of 'O') + 4mod(26) = S
- C_{1}[4] = (position of 'O') + 4mod(26) = S
- C_{1}[5] = (position of 'R') + 4mod(26) = V
- Hence the string is OLSSV


******* Decrypt Ciphertext ABC, k=3
- A: $(0-3)\mod26 = -3\mod(26) = (-3+26)\mod(26) = 23$


******* Cryptanalysis

******** Break the ciphertext WKLV using cryptanalysis
The program given below is a very simple Python Script to generate all possible
plaintexts for a given ciphertext.
#+begin_src python :results output raw :wrap src :exports both :session ceasar
def breakCaesar(x):
    for k in range(26):
        for c in x.upper():
            shift = (ord(c) - ord('A') - k)%26 
            cipher_char = chr(ord('A')+shift)
            print(cipher_char, end="")
        print(end=", ")
        
breakCaesar("WKLV")

#+end_src

#+RESULTS:
#+begin_src
WKLV, VJKU, UIJT, THIS, SGHR, RFGQ, QEFP, PDEO, OCDN, NBCM, MABL, LZAK, KYZJ, JXYI, IWXH, HVWG, GUVF, FTUE, ESTD, DRSC, CQRB, BPQA, AOPZ, ZNOY, YMNX, XLMW,
#+end_src

*Explanation*: For each alphabet, this is what's happening:
- ~ord(c) - ord('A')~ is basically the difference between the ASCII value of the
  character in the string, and the ASCII value of the letter 'A'. This
  difference is in the range 0-25. ~ord(c) - ord('A')~ is the value of $C$ in
  $D(C) = (C-K)\mod(26)$.
- ~- k~ is doing the $(C-K)$ part in $D(C) = (C-K)\mod(26)$.
- ~% 26~ is doing the $\mod(26)$ part in $D(C) = (C-K)\mod(26)$.
- We add ~ord('A')~ to the shift so that we can convert this number back to ASCII.
- To convert the ASCII value back into a number, we have to typecast it into a
  character, by passing it into the ~chr()~ function.


******** Break the ciphertext GWTBS

#+begin_src python :results output raw :wrap src :exports both :session ceasar
breakCaesar("GWTBS")
#+end_src

#+RESULTS:
#+begin_src
GWTBS, FVSAR, EURZQ, DTQYP, CSPXO, BROWN, AQNVM, ZPMUL, YOLTK, XNKSJ, WMJRI, VLIQH, UKHPG, TJGOF, SIFNE, RHEMD, QGDLC, PFCKB, OEBJA, NDAIZ, MCZHY, LBYGX, KAXFW, JZWEV, IYVDU, HXUCT,
#+end_src




***** Simple Substitution/ Monoalphabetic
- Rather than shifting the alphabets, you shuffle the alphabets randomly.
- Every plain text letter maps to a random cipher text letter, hence there are
  26 keys.
- Given a ciphertext, there are $26!$ possible plain texts.
- The relative *letter frequencies* never change.

***** Polygram
- A block of plain text symbols is replaced by a corresponding ciphertext block
  of characters.
- Sequence of two plain text characters are known as *digrams*, replaced by other
  digrams.
- For example, the word 
  #+begin_src txt
CO LL EG Ex
  #+end_src
  This can become, say (random, just for example):
  #+begin_src txt
xy ab up ld
  #+end_src

****** Playfair Cipher

******* Explanation
- Make a $5 \times 5$ matrix. In these 25 spaces, you'll have to fill all 26
  alphabets. To accommodate the extra alphabet, we merge I and J in one box, by
  convention.
- You start by filling the alphabets of the keyword given (without repetition).
- After you're done with that, start with the rest of the alphabet, and fill in
  the rest of the gaps in order without repetition.

  

******** Example we'll be using to learn the rules
- keyword: CRYPTOGRAPHY CLASS SPRING

| C | R   | Y | P | T |
| O | G   | A | H | L |
| S | I/J | N | B | D |
| E | F   | K | M | Q |
| U | V   | W | X | Z |



******** How to Encrypt a given plain text

1. If letters of a pair are both same, then add an x after the first letter and
   encrypt the new pair.
   - For example: If you have the word ~H E L L O~, you'd resolve it as:
     #+begin_src txt
HE LX LO
     #+end_src
     and not
     #+begin_src txt
HE LL O
     #+end_src
2. If letters appear on the same row, replace them with the letters to their
   immediate right with wrapping, according to the direction.
   - For example, consider one row of the matrix to be:
     
     | O | G   | A | H | L |

     For ~HA~, the corresponding plain text could be ~LH~ or ~AG~. In our course,
     we'll stick to ~AG~.
     
3. If letters appear on the same column, replace them with the letters
   immediately below, also with wrapping according to the direction.
   - For example, consider one column of the matrix to be:
     
     | Y |    
     | A |
     | N |
     | K |
     | W |

     - For ~NK~, the corresponding plain text would be ~KW~.

     - For ~YW~, the corresponding plain text would be ~AY~.

4. If letters are not on the same row/column, replace them with the letters on
   the same row respectively but add the other pair of corners of the rectangle,
   by the original pair.
   
   

******** Demonstration of the plain text being encrypted
- Consider the plain text "Hello find the solution".
- This will be broken into:
  #+begin_src txt
HE   LX   LO   FI   ND   TH   ES   OL   UT   IO   NZ
  #+end_src
- And the encrypted text will look like:
  #+begin_src txt
OQ   OZ   OG   IG   BS   PL   SO   GO   ZC   SG   DW             
  #+end_src
  



******* Solving another Example
- Keyword: KEYWORD

  | K | E | Y | W   | O |
  | R | D | A | B   | C |
  | F | G | H | I/J | L |
  | M | N | P | Q   | S |
  | T | U | V | X   | Z |

  
******** Plain Text: *Why don't you*
- This will be broken into:
  #+begin_src txt
WH   YD   ON   TY   OU
  #+end_src
- And the encrypted text will look like:
  #+begin_src txt
KL   OR   KS   ZK   KZ
  #+end_src


******** Plain Text: *Come to the window*
- This will be broken into:
  #+begin_src txt
CO   ME   TO   TH   EW   IN   DO   WX
  #+end_src
- And the encrypted text will look like:
  #+begin_src txt
OZ   NK   ZK   VF   YO   GQ   CE   BW
  #+end_src



***** Homophonic
- If a letter $x$ appears for $y\%$ of all characters, we assign $y$ number of
  symbols to represent it.

***** Polyalphabetic
- In Caesar cipher, the key was a single number.
- Polyalphabetic cipher uses a key to select which alphabet is used for each
  alphabet of the message.
- Once the key reaches the end it is repeated from the beginning to match the
  length of the plain text.

****** Vigenere Cipher

******* Encryption
- This is one of the simplest polyalphabetic substitution cipher.
- It is effectively multiple caeser ciphers.
- $K = K_{1} K_{2} K_{3}....K_{L}$, where $L$ is the length of the key.
- The same plain text character is encrypted to different cipher text characters.
- Assume plain text to be "WE ARE DISCOVERED SAVE YOURSELF" and the key to be "DECEPTIVE"
  
  Making the alphabet-index mapping programmatically:
  #+begin_src python :results output raw :exports both
print('|', end='')
for i in range(26):
    print(f'{i} - {chr(ord('A')+i)} |', end='')

  #+end_src

  #+RESULTS:
  | 0 - A | 1 - B | 2 - C | 3 - D | 4 - E | 5 - F | 6 - G | 7 - H | 8 - I | 9 - J | 10 - K | 11 - L | 12 - M | 13 - N | 14 - O | 15 - P | 16 - Q | 17 - R | 18 - S | 19 - T | 20 - U | 21 - V | 22 - W | 23 - X | 24 - Y | 25 - Z |

- We map each alphabet of the plain text to the key repeated as many times as
  required:
  
  #+begin_src txt
W E A R E D I S C O V E R E D S A V E Y O U R S E L F
D E C E P T I V E D E C E P T I V E D E C E P T I V E
_____________________________________________________
Z I C V T W Q N G R Z G V T W A V Z H C Q Y G L M G J
  #+end_src
  
- In Vigenere Cipher the length of the keyword can be found out as two identical
  sequences of plain text letters occur at a distance that is an integer
  multiple of the keyword length will generate identical cipher text sequences.

- Since the periodic nature of the keyword was the issue, Vigenere proposed an
  *autokey system*, in which a keyword is concatenated with the plain text to
  match the length of the plain text.
  
  #+begin_src txt
W E A R E D I S C O V E R E D S A V E Y O U R S E L F
D E C E P T I V E W E A R E D I S C O V E R E D S A V 
_____________________________________________________
  #+end_src


******* Cryptanalysis

******** Example 1: Plain Text = "acbxzcb", Cipher Text = "bxbywdb"

|               | ~0~ | ~1~ | ~2~ | ~3~ | ~4~ | ~5~ | ~6~ |
| *Plain Text* \rightarrow  | a | c | b | x | z | c | b |
| *Cipher Text* \rightarrow | b | x | b | y | w | d | b |



****** Vennam Cipher (one-time pad)
- You perform bitwise XOR on the ASCII value of the characters of the plain text
  and the key.
- Here is the XOR Table:

  | A | B | A XOR B |
  |---+---+---------|
  | 0 | 0 |       0 |
  | 0 | 1 |       1 |
  | 1 | 0 |       1 |
  | 1 | 1 |       0 |
  
- For example:
  |              | String Given | Char-by-char ASCII Value | Char-by-char value in Binary |
  |--------------+--------------+--------------------------+------------------------------|
  | *Plain text* \rightarrow | CAT          |                   676584 |     010000110100000101010100 |
  | *Key* \rightarrow        | DOG          |                   687971 |     010001000100111101000111 |
  |--------------+--------------+--------------------------+------------------------------|
  |              |              |     *Plain Text XOR Key* \rightarrow |     000001110000111000010011 |

- One thing to note is that the key length has to be at least as long as the
  plain text.

- Theoretically, this cipher is impossible to decrypt because the key has to be
  purely random.

  
**** Transposition / Permutation Cipher
- This cipher hides the message by rearranging the letters of the plain text
  without changing the actual letters.

****** Railfence Cipher
- Here you write message's letters diagonally over the rows, then read the
  message row-by-row.
- For example, plain text = "meet me after the party", and the number of rows
  is 3.

  | m |   |   |   | _ |   |   |   | a |   |   |   | r |   |   |   | e |   |   |   | r |   |   |
  |   | e |   | t |   | m |   | _ |   | f |   | e |   | _ |   | h |   | _ |   | a |   | t |   |
  |   |   | e |   |   |   | e |   |   |   | t |   |   |   | t |   |   |   | p |   |   |   | y |
  
- The cipher text would be "m areretm fe h ateetpy"


****** Columnar Transposition
- Write the characters of the message in rows over a specified number of
  columns.
- The number of columns is the length of the key, and the key tells us the order
  in which the cipher text is written.
- The cipher text is essentially the columns of this table written in the order
  the key was mentioned.
- For example, key = 4312567 (meaning 7 columns), and the plain text is "attack
  postponed until two am"

  | 4 | 3 | 1 | 2 | 5 | 6 | 7 |
  |---+---+---+---+---+---+---|
  | a | t | t | a | c | k | p |
  | o | s | t | p | o | n | e |
  | d | u | n | t | i | l | t |
  | w | o | a | m | x | y | z |

  The cipher text would be "ttnaaptmtsuoaodwcoixknlypetz".


**** Product

*** Based on Number of Keys

**** Single/Private Key
- It's called *symmetric key encryption*.

**** Two-key or Public Key cryptography
- It's called *assymmetric key encryption*.

*** Based on how plaintext is processed

**** Block
- Block Cipher transforms a fixed length of plaintext data into a block of
  ciphertext of the same length, with the help of a secret key.
- The most commonly used length of text (size of the block) is 64 bits.
- Two types are:
  - Transposition
  - Substitution

**** Stream
